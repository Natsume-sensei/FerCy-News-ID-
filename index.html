<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="pseGoaomewXgIkGorPEY_V7J5CFv0GVEqIlpyADW2Q4" />
    <title>FerCy News ID Portal</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,300;0,400;0,700;1,300&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">

    <style>
        :root {
            --primary-color: #2563eb;
            --accent-color: #f59e0b;
            --bg-light: #f3f4f6;
            --text-light: #1f2937;
            --card-light: #ffffff;
            --bg-dark: #111827;
            --text-dark: #f9fafb;
            --card-dark: #1f2937;
            --border-light: #e5e7eb;
            --border-dark: #374151;
            
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* --- BASIC SETUP --- */
        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--bg-light);
            color: var(--text-light);
            transition: var(--transition);
            margin: 0; padding: 0;
            overflow-x: hidden;
            top: 0 !important;
            display: flex; flex-direction: column; min-height: 100vh;
        }

        body.dark-mode { background-color: var(--bg-dark); color: var(--text-dark); }
        body.dark-mode .card, body.dark-mode header, body.dark-mode .modal-content {
            background-color: var(--card-dark); color: var(--text-dark); border-color: var(--border-dark);
        }
        
        body.dark-mode input, body.dark-mode select, body.dark-mode .ql-toolbar, body.dark-mode .ql-container {
            background-color: #374151; color: white; border-color: #4b5563;
        }
        body.dark-mode .ql-stroke { stroke: #fff; }
        body.dark-mode .ql-fill { fill: #fff; }
        
        h1, h2, h3, .article-title { font-family: 'Merriweather', serif; }

        /* HEADER */
        header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 1rem 2%; background: var(--card-light);
            box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
            position: sticky; top: 0; z-index: 100;
        }
        .logo { font-size: 1.5rem; font-weight: 700; color: var(--primary-color); cursor: pointer;}
        .logo span { color: var(--accent-color); }
        .nav-tools { display: flex; gap: 1rem; align-items: center; }
        
        /* BUTTONS */
        .btn {
            padding: 0.5rem 1rem; border-radius: 8px; border: none;
            cursor: pointer; transition: var(--transition); font-weight: 500;
        }
        .btn-primary { background: var(--primary-color); color: white; }
        .btn-success { background: #10b981; color: white; }
        .btn-warning { background: #f59e0b; color: white; } 
        .btn-outline { border: 1px solid var(--primary-color); color: var(--primary-color); background: transparent; }
        .btn-danger { background: #dc2626; color: white; }
        .btn:hover { transform: translateY(-2px); opacity: 0.9; }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

        /* WIDGETS */
        #google_translate_element { margin-right: 15px; min-width: 120px; }
        .goog-te-gadget-simple { background: transparent !important; border: 1px solid var(--primary-color) !important; padding: 5px !important; border-radius: 6px !important; }
        .goog-te-banner-frame { display: none !important; }

        /* TICKER */
        .ticker-wrap { width: 100%; background-color: var(--primary-color); color: white; height: 40px; overflow: hidden; display: flex; align-items: center; }
        .ticker-heading { background: #1e40af; padding: 0 1rem; height: 100%; display: flex; align-items: center; font-weight: bold; z-index: 10; }
        .ticker-move { display: inline-block; white-space: nowrap; padding-right: 100%; animation: ticker 30s linear infinite; }
        .ticker-item { display: inline-block; padding: 0 2rem; cursor: pointer; }
        @keyframes ticker { 0% { transform: translate3d(0, 0, 0); } 100% { transform: translate3d(-100%, 0, 0); } }

        /* LAYOUT */
        .container {
            display: grid; grid-template-columns: 250px 1fr; gap: 2rem;
            padding: 2rem 1.5%; max-width: 100%; width: 100%; box-sizing: border-box; margin: 0; flex: 1; 
        }

        /* SIDEBAR */
        .sidebar-section { margin-bottom: 2rem; }
        .tag-cloud { display: flex; flex-wrap: wrap; gap: 0.5rem; }
        .tag { font-size: 0.85rem; padding: 0.2rem 0.6rem; background: rgba(37, 99, 235, 0.1); color: var(--primary-color); border-radius: 20px; cursor: pointer; }
        .cat-item { display: block; padding: 0.5rem 0; border-bottom: 1px solid var(--border-light); cursor: pointer; }
        body.dark-mode .cat-item { border-color: var(--border-dark); }
        .search-box { width: 100%; padding: 0.8rem; border-radius: 8px; border: 1px solid #ccc; margin-bottom: 1rem; box-sizing: border-box; }

        /* GRID ARTIKEL */
        .articles-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 2rem; width: 100%; }
        .article-card-container { perspective: 1000px; height: 420px; }
        .article-card { position: relative; width: 100%; height: 100%; text-align: left; transition: transform 0.8s; transform-style: preserve-3d; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-radius: 12px; }
        .article-card-container:hover .article-card { transform: rotateY(180deg); }
        
        .card-front, .card-back { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 12px; overflow: hidden; background: var(--card-light); }
        body.dark-mode .card-front, body.dark-mode .card-back { background: var(--card-dark); }
        
        .card-img { height: 200px; width: 100%; object-fit: cover; }
        .card-content { padding: 1.5rem; }
        .card-cat { color: var(--accent-color); font-size: 0.8rem; font-weight: bold; text-transform: uppercase; }
        .card-title { font-size: 1.2rem; margin: 0.5rem 0; line-height: 1.4; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden;}
        .card-meta { font-size: 0.8rem; color: #6b7280; display: flex; justify-content: space-between; margin-top: auto; }
        
        .card-back { transform: rotateY(180deg); padding: 2rem; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; background: linear-gradient(135deg, var(--card-light) 0%, #f0f9ff 100%); }
        body.dark-mode .card-back { background: linear-gradient(135deg, var(--card-dark) 0%, #111827 100%); }
        
        .share-buttons { margin: 1.5rem 0; display: flex; gap: 1rem; }
        .share-btn { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; text-decoration: none; transition: 0.3s; }
        .share-btn:hover { transform: scale(1.1); }
        .fb { background: #3b5998; } .tw { background: #1da1f2; } .wa { background: #25d366; }
        
        /* PAGINATION */
        .pagination-container { grid-column: 1 / -1; display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 2rem; }
        .page-info { font-size: 0.9rem; opacity: 0.8; }
        
        /* MODAL */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; overflow-y: auto; backdrop-filter: blur(5px); }
        .modal-content { background: var(--card-light); margin: 2% auto; width: 90%; max-width: 900px; border-radius: 12px; position: relative; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); animation: slideUp 0.3s ease-out; padding: 0; }
        .form-content { padding: 20px; }
        .modal-small { max-width: 400px; margin-top: 15%; padding: 2rem; text-align: center; }
        .close { position: absolute; right: 15px; top: 15px; width: 40px; height: 40px; background: rgba(0, 0, 0, 0.6); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; cursor: pointer; color: #ffffff !important; z-index: 2000; transition: all 0.3s ease; }
        .close:hover { background: #dc2626; transform: rotate(90deg); }

        /* DASHBOARD */
        .admin-dashboard { width: 95%; max-width: 1200px; margin: 2% auto; padding: 20px; }
        .dashboard-stats { display: grid; grid-template-columns: 1fr 1fr 2fr; gap: 2rem; margin-bottom: 2rem; }
        .stat-card { background: rgba(37, 99, 235, 0.1); padding: 1.5rem; border-radius: 12px; text-align: center; border: 1px solid var(--primary-color); }
        .stat-card.pending { background: rgba(245, 158, 11, 0.1); border-color: var(--accent-color); }
        .stat-number { font-size: 3rem; font-weight: bold; color: var(--primary-color); }
        .stat-card.pending .stat-number { color: var(--accent-color); }
        
        .pie-chart-container { display: flex; align-items: center; justify-content: center; gap: 2rem; background: rgba(255,255,255,0.05); padding: 1rem; border-radius: 12px; border: 1px solid var(--border-light); }
        .pie-chart { width: 150px; height: 150px; border-radius: 50%; background: conic-gradient(var(--primary-color) 0deg 360deg); }
        .legend { font-size: 0.85rem; }
        .legend-item { display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.3rem; }
        .legend-color { width: 12px; height: 12px; border-radius: 2px; }

        .admin-table-container { overflow-x: auto; }
        .admin-table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
        .admin-table th, .admin-table td { padding: 1rem; text-align: left; border-bottom: 1px solid var(--border-light); }
        body.dark-mode .admin-table th, body.dark-mode .admin-table td { border-color: var(--border-dark); }
        .admin-table th { background: rgba(0,0,0,0.05); font-weight: 600; }
        body.dark-mode .admin-table th { background: rgba(255,255,255,0.05); }

        .badge { padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.75rem; font-weight: bold; }
        .badge-published { background: #d1fae5; color: #065f46; }
        .badge-pending { background: #fef3c7; color: #92400e; }

        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        /* FORM */
        .form-group { margin-bottom: 1.5rem; text-align: left; }
        .form-label { display: block; margin-bottom: 0.5rem; font-weight: 500; }
        .form-input { width: 100%; padding: 0.8rem; border: 1px solid #ccc; border-radius: 6px; background: transparent; color: inherit; box-sizing: border-box; }
        #editor { height: 300px; }

        /* READ */
        .read-header { position: relative; height: 350px; width: 100%; }
        .read-cover { width: 100%; height: 100%; object-fit: cover; border-top-left-radius: 12px; border-top-right-radius: 12px; mask-image: linear-gradient(to bottom, black 70%, transparent 100%); -webkit-mask-image: linear-gradient(to bottom, black 70%, transparent 100%); }
        .read-body { padding: 2rem 3rem; }
        .read-content img { max-width: 100%; height: auto; border-radius: 8px; margin: 1rem 0; }
        
        /* FOOTER */
        .site-footer { background-color: #ffffff; border-top: 1px solid var(--border-light); padding: 3rem 2% 1rem 2%; margin-top: 4rem; }
        body.dark-mode .site-footer { background-color: var(--card-dark); border-color: var(--border-dark); }
        .footer-content { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; width: 100%; margin: 0 auto; }
        .footer-col h4 { color: var(--primary-color); margin-bottom: 1.2rem; font-size: 1.1rem; }
        .footer-links a { display: block; margin-bottom: 0.8rem; color: inherit; text-decoration: none; transition: 0.3s; opacity: 0.8; }
        .footer-links a:hover { color: var(--primary-color); padding-left: 5px; opacity: 1; }
        .footer-social-share { display: flex; gap: 1rem; }
        .footer-share-btn { width: 45px; height: 45px; border-radius: 50%; background: var(--bg-light); display: flex; align-items: center; justify-content: center; color: var(--text-light); text-decoration: none; transition: all 0.3s ease; font-size: 1.2rem; }
        body.dark-mode .footer-share-btn { background: #374151; color: #fff; }
        .footer-share-btn:hover { background: var(--primary-color); color: white; transform: translateY(-5px); box-shadow: 0 5px 15px rgba(37, 99, 235, 0.3); }
        .copyright-bar { margin-top: 3rem; padding-top: 1.5rem; border-top: 1px solid var(--border-light); text-align: center; font-size: 0.9rem; opacity: 0.7; }
        body.dark-mode .copyright-bar { border-color: var(--border-dark); }

        @media (max-width: 768px) {
            .container { grid-template-columns: 1fr; }
            .dashboard-stats { grid-template-columns: 1fr; }
            .pie-chart-container { flex-direction: column; }
            .nav-tools { flex-wrap: wrap; justify-content: center; gap: 0.5rem;}
            .read-body { padding: 1.5rem; }
        }
    </style>
</head>
<body>

    <header>
        <div class="logo" onclick="location.reload()"><i class="fas fa-newspaper"></i> FerCy<span>News ID</span></div>
        <div class="nav-tools">
            <div id="google_translate_element"></div>
            <button id="adminBtn" class="btn btn-outline" onclick="handleAdminClick()"><i class="fas fa-user-lock"></i> <span id="adminText">Login Admin</span></button>
            <button id="themeToggle" class="btn btn-outline" title="Ganti Tema"><i class="fas fa-moon"></i></button>
            <button class="btn btn-primary" onclick="openWriteModal()"><i class="fas fa-pen-nib"></i> Tulis Artikel</button>
        </div>
    </header>

    <div class="ticker-wrap">
        <div class="ticker-heading">BREAKING NEWS</div>
        <div class="ticker-move" id="tickerContent"></div>
    </div>

    <div class="container">
        <aside>
            <input type="text" id="searchInput" class="search-box" placeholder="Cari artikel..." onkeyup="handleSearch()">
            <div class="sidebar-section">
                <h3>Rubrik</h3>
                <div class="cat-list">
                    <span class="cat-item" onclick="filterByCategory('Semua')">Semua</span>
                    <span class="cat-item" onclick="filterByCategory('Sains')">Sains</span>
                    <span class="cat-item" onclick="filterByCategory('Teknologi')">Teknologi</span>
                    <span class="cat-item" onclick="filterByCategory('Lingkungan')">Lingkungan</span>
                    <span class="cat-item" onclick="filterByCategory('Sosial')">Sosial</span>
                    <span class="cat-item" onclick="filterByCategory('Ekonomi')">Ekonomi</span>
                    <span class="cat-item" onclick="filterByCategory('Politik')">Politik</span>
                    <span class="cat-item" onclick="filterByCategory('Pendidikan')">Pendidikan</span>
                    <span class="cat-item" onclick="filterByCategory('Pertahanan dan Keamanan')">Pertahanan & Keamanan</span>
                    <span class="cat-item" onclick="filterByCategory('Bisnis')">Bisnis</span>
                    <span class="cat-item" onclick="filterByCategory('Olahraga')">Olahraga</span>
                    <span class="cat-item" onclick="filterByCategory('Infografik')">Infografik</span>
                </div>
            </div>
            <div class="sidebar-section">
                <h3>Trending Tags <i class="fas fa-bolt" style="color:var(--accent-color)"></i></h3>
                <div class="tag-cloud" id="trendingTags"></div>
            </div>
        </aside>

        <main>
            <div class="articles-grid" id="articlesGrid"></div>
            
            <div class="pagination-container" id="paginationControls"></div>
        </main>
    </div>

    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-col">
                <div class="logo"><i class="fas fa-newspaper"></i> FerCy<span>News ID</span></div>
                <p style="margin-top: 1rem; line-height: 1.6; opacity: 0.8;">Platform berita terdepan yang menyajikan informasi aktual, tajam, dan terpercaya. Berkomitmen untuk mencerdaskan kehidupan bangsa melalui jurnalisme berkualitas.</p>
            </div>
            <div class="footer-col">
                <h4>Informasi & Kebijakan</h4>
                <div class="footer-links">
                    <a href="javascript:void(0)" onclick="openPedomanModal()">Pedoman Media Siber</a>
                    <a href="#">Tentang Kami</a>
                    <a href="#">Kode Etik Jurnalistik</a>
                    <a href="#">Kebijakan Privasi</a>
                    <a href="#">Kontak Redaksi</a>
                </div>
            </div>
            <div class="footer-col">
                <h4>Bagikan Portal Ini</h4>
                <div class="footer-social-share">
                    <a href="#" class="footer-share-btn"><i class="fab fa-whatsapp"></i></a>
                    <a href="#" class="footer-share-btn"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="footer-share-btn"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="footer-share-btn"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
        </div>
        <div class="copyright-bar">&copy; 2025 FerCy News ID. All Rights Reserved.</div>
    </footer>

    <div id="writeModal" class="modal">
        <div class="modal-content form-content">
            <span class="close" onclick="closeWriteModal()">&times;</span>
            <h2 id="modalTitle"><i class="fas fa-edit"></i> Kontribusi Artikel</h2>
            <form id="articleForm" onsubmit="submitArticle(event)">
                <input type="hidden" id="postId">
                <input type="hidden" id="targetStatus" value="pending">

                <div class="form-group">
                    <label class="form-label">Judul Artikel</label>
                    <input type="text" id="postTitle" class="form-input" required placeholder="Judul menarik...">
                </div>
                <div class="form-group" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div>
                        <label class="form-label">Nama Penulis</label>
                        <input type="text" id="postAuthor" class="form-input" required>
                    </div>
                    <div>
                        <label class="form-label">Kategori</label>
                        <select id="postCategory" class="form-input">
                            <option>Sains</option>
                            <option>Teknologi</option>
                            <option>Lingkungan</option>
                            <option>Sosial</option>
                            <option>Ekonomi</option>
                            <option>Politik</option>
                            <option>Masyarakat</option>
                            <option>Pendidikan</option>
                            <option>Pertahanan dan Keamanan</option>
                            <option>Bisnis</option>
                            <option>Olahraga</option>
                            <option>Infografik</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">URL Gambar Cover</label>
                    <input type="url" id="postImage" class="form-input" placeholder="https://..." required>
                </div>
                <div class="form-group">
                    <label class="form-label">Tags (Pisahkan dengan koma)</label>
                    <input type="text" id="postTags" class="form-input" placeholder="#inovasi, #masaDepan">
                </div>
                <div class="form-group">
                    <label class="form-label">Isi Berita</label>
                    <div id="editor"></div>
                </div>
                
                <div id="userButtons" style="margin-top: 1.5rem;">
                    <button type="submit" class="btn btn-primary" style="width: 100%; padding: 1rem;" onclick="setTargetStatus('pending')">Submit Artikel</button>
                </div>

                <div id="adminButtons" style="display: flex; gap: 10px; margin-top: 1.5rem; display: none;">
                    <button type="submit" class="btn btn-warning" style="flex: 1; padding: 1rem;" onclick="setTargetStatus('pending')">
                        <i class="fas fa-file-alt"></i> Simpan Draft
                    </button>
                    <button type="submit" class="btn btn-success" style="flex: 1; padding: 1rem;" onclick="setTargetStatus('published')">
                        <i class="fas fa-check"></i> Publikasikan
                    </button>
                </div>
            </form>
        </div>
    </div>

    <div id="readModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeReadModal()">&times;</span>
            <div id="readContentContainer"></div>
        </div>
    </div>

    <div id="pedomanModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closePedomanModal()">&times;</span>
            <div class="read-body">
                <h1 style="text-align:center; margin-bottom: 2rem;">Pedoman Pemberitaan Media Siber</h1>
                <div class="ql-editor" style="text-align: justify;"><p>Kemerdekaan berpendapat...</p></div>
            </div>
        </div>
    </div>

    <div id="loginModal" class="modal">
        <div class="modal-content modal-small">
            <span class="close" onclick="closeLoginModal()">&times;</span>
            <h2><i class="fas fa-lock"></i> Login Admin</h2>
            <div class="form-group" style="margin-top: 1rem;">
                <input type="password" id="adminPassword" class="form-input" placeholder="Password...">
            </div>
            <button class="btn btn-primary" onclick="verifyAdmin()" style="width:100%">Masuk</button>
        </div>
    </div>

    <div id="adminDashboardModal" class="modal">
        <div class="modal-content admin-dashboard">
            <span class="close" onclick="closeAdminDashboard()">&times;</span>
            <h2><i class="fas fa-tachometer-alt"></i> Admin Dashboard</h2>
            
            <div class="dashboard-stats">
                <div class="stat-card">
                    <h3>Total Artikel</h3>
                    <div class="stat-number" id="totalArticlesCount">0</div>
                    <p>Aktif & Pending</p>
                </div>
                <div class="stat-card pending">
                    <h3>Menunggu Review</h3>
                    <div class="stat-number" id="pendingArticlesCount">0</div>
                    <p>Perlu Persetujuan</p>
                </div>
                <div class="pie-chart-container" id="chartContainer">
                    <div class="pie-chart" id="categoryPieChart"></div>
                    <div class="legend" id="categoryLegend"></div>
                </div>
            </div>

            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <h3>Manajemen Artikel</h3>
                <button class="btn btn-danger" onclick="bulkDeleteArticles()"><i class="fas fa-trash"></i> Hapus Terpilih</button>
            </div>

            <div class="admin-table-container">
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th width="5%"><input type="checkbox" onchange="toggleSelectAll(this)"></th>
                            <th width="30%">Judul Artikel</th>
                            <th width="15%">Penulis</th>
                            <th width="10%">Kategori</th>
                            <th width="10%">Status</th>
                            <th width="15%">Tanggal</th>
                            <th width="15%">Aksi</th>
                        </tr>
                    </thead>
                    <tbody id="adminTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <script type="text/javascript">
        function googleTranslateElementInit() { new google.translate.TranslateElement({ pageLanguage: 'id', layout: google.translate.TranslateElement.InlineLayout.SIMPLE, autoDisplay: false }, 'google_translate_element'); }
    </script>
    <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

    <script>
        // --- DATA & SETUP ---
        let articles = JSON.parse(localStorage.getItem('fercyArticles')) || [
            { id: 1, title: "Revolusi Hijau: Kota Masa Depan", author: "Sarah Wijaya", date: "2025-10-12", category: "Lingkungan", image: "https://images.unsplash.com/photo-1518005052357-e9847508d571?auto=format&fit=crop&w=800&q=80", tags: ["#EcoCity"], status: 'published', content: "<h3>Kota Ramah Lingkungan</h3><p>Kota masa depan...</p>" },
            { id: 2, title: "AI Generatif dan Etika Digital", author: "Budi Santoso", date: "2025-11-05", category: "Teknologi", image: "https://images.unsplash.com/photo-1677442136019-21780ecad995?auto=format&fit=crop&w=800&q=80", tags: ["#AI"], status: 'published', content: "<h3>Kecerdasan Buatan</h3><p>AI semakin canggih...</p>" },
            { id: 3, title: "Transformasi Pendidikan 2025", author: "Prof. Handoko", date: "2025-12-01", category: "Pendidikan", image: "https://images.unsplash.com/photo-1509062522246-3755977927d7?auto=format&fit=crop&w=800&q=80", tags: ["#Edukasi"], status: 'published', content: "<h3>Sekolah Digital</h3><p>Belajar dari rumah...</p>" }
        ];

        // Normalisasi data lama
        articles = articles.map(a => {
            if(!a.status) a.status = 'published';
            return a;
        });

        // --- OPTIMIZATION VARIABLES (PAGINATION) ---
        const ITEMS_PER_PAGE = 9; // Batasi 9 artikel per halaman agar ringan
        let currentPage = 1;
        let currentFilteredArticles = []; // Menyimpan hasil filter sebelum dipaginasi

        // --- ADMIN LOGIC ---
        let isAdmin = false;

        function handleAdminClick() { isAdmin ? openAdminDashboard() : openLoginModal(); }
        
        function verifyAdmin() {
            if (document.getElementById('adminPassword').value === '1234') {
                isAdmin = true;
                document.getElementById('adminText').innerText = "Dashboard Admin";
                document.getElementById('adminBtn').classList.replace('btn-outline', 'btn-primary');
                closeLoginModal(); openAdminDashboard(); 
                alert("Login Berhasil! Selamat datang Admin.");
            } else { alert("Password Salah!"); }
        }

        function openAdminDashboard() { document.getElementById('adminDashboardModal').style.display = 'block'; renderAdminDashboard(); }
        function closeAdminDashboard() { document.getElementById('adminDashboardModal').style.display = 'none'; }

        function renderAdminDashboard() {
            document.getElementById('totalArticlesCount').innerText = articles.length;
            document.getElementById('pendingArticlesCount').innerText = articles.filter(a => a.status === 'pending').length;

            const catCount = {}; articles.forEach(a => { catCount[a.category] = (catCount[a.category] || 0) + 1; });
            const colors = ['#2563eb', '#f59e0b', '#10b981', '#ef4444', '#8b5cf6', '#ec4899', '#6366f1', '#14b8a6'];
            let gradientStr = [], currentDeg = 0, legendHtml = '', colorIndex = 0;

            for (const [cat, count] of Object.entries(catCount)) {
                const percentage = (count / articles.length) * 360;
                const color = colors[colorIndex % colors.length];
                gradientStr.push(`${color} ${currentDeg}deg ${currentDeg + percentage}deg`);
                currentDeg += percentage;
                legendHtml += `<div class="legend-item"><div class="legend-color" style="background:${color}"></div><span>${cat} (${count})</span></div>`;
                colorIndex++;
            }
            document.getElementById('categoryPieChart').style.background = `conic-gradient(${gradientStr.join(', ')})`;
            document.getElementById('categoryLegend').innerHTML = legendHtml;

            const tbody = document.getElementById('adminTableBody'); tbody.innerHTML = '';
            const sortedArticles = [...articles].sort((a, b) => (a.status === 'pending' ? -1 : 1));

            sortedArticles.forEach(art => {
                const statusBadge = art.status === 'published' ? `<span class="badge badge-published">Published</span>` : `<span class="badge badge-pending">Pending</span>`;
                const quickPublishBtn = art.status === 'pending' ? `<button class="btn btn-success" style="padding:0.3rem 0.6rem; font-size:0.8rem;" title="Publikasi Cepat" onclick="quickPublish(${art.id})"><i class="fas fa-check"></i></button>` : '';

                tbody.innerHTML += `
                    <tr>
                        <td><input type="checkbox" class="bulk-check" value="${art.id}"></td>
                        <td>${art.title}</td> <td>${art.author}</td> <td><span class="tag">${art.category}</span></td> <td>${statusBadge}</td> <td>${art.date}</td>
                        <td style="display:flex; gap:5px;">
                            ${quickPublishBtn}
                            <button class="btn btn-primary" style="padding:0.3rem 0.6rem; font-size:0.8rem;" title="Edit Lengkap" onclick="openEditArticle(${art.id})"><i class="fas fa-pen"></i></button>
                            <button class="btn btn-danger" style="padding:0.3rem 0.6rem; font-size:0.8rem;" title="Hapus" onclick="deleteOneArticle(${art.id})"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>`;
            });
        }

        // --- EDIT & PUBLISH LOGIC ---
        function setTargetStatus(status) { document.getElementById('targetStatus').value = status; }

        function quickPublish(id) {
            if(confirm("Publikasikan artikel ini sekarang?")) {
                const art = articles.find(a => a.id === id);
                if(art) { art.status = 'published'; saveAndRefresh(); }
            }
        }

        function openEditArticle(id) {
            const art = articles.find(a => a.id === id);
            if(!art) return;

            document.getElementById('modalTitle').innerHTML = '<i class="fas fa-edit"></i> Edit Artikel (Admin)';
            document.getElementById('postId').value = art.id;
            document.getElementById('postTitle').value = art.title;
            document.getElementById('postAuthor').value = art.author;
            document.getElementById('postCategory').value = art.category;
            document.getElementById('postImage').value = art.image;
            document.getElementById('postTags').value = art.tags.join(', ');
            quill.root.innerHTML = art.content;

            if(isAdmin) {
                document.getElementById('userButtons').style.display = 'none';
                document.getElementById('adminButtons').style.display = 'flex';
            } else {
                document.getElementById('userButtons').style.display = 'block';
                document.getElementById('adminButtons').style.display = 'none';
            }
            
            document.getElementById('writeModal').style.display = 'block';
        }

        function submitArticle(e) {
            e.preventDefault();
            
            const postId = document.getElementById('postId').value;
            const targetStatus = document.getElementById('targetStatus').value;
            
            const title = document.getElementById('postTitle').value;
            const author = document.getElementById('postAuthor').value;
            const category = document.getElementById('postCategory').value;
            const image = document.getElementById('postImage').value;
            const tags = document.getElementById('postTags').value.split(',').map(t=>t.trim().startsWith('#')?t.trim():'#'+t.trim());
            const content = quill.root.innerHTML;

            if (postId) {
                const index = articles.findIndex(a => a.id == postId);
                if (index !== -1) {
                    articles[index].title = title;
                    articles[index].author = author;
                    articles[index].category = category;
                    articles[index].image = image;
                    articles[index].tags = tags;
                    articles[index].content = content;
                    articles[index].status = targetStatus;
                    alert(`Artikel berhasil diperbarui menjadi: ${targetStatus === 'published' ? 'PUBLISHED' : 'DRAFT'}`);
                }
            } else {
                const newArt = {
                    id: Date.now(),
                    title: title, author: author, category: category, image: image, tags: tags, content: content,
                    date: new Date().toISOString().split('T')[0],
                    status: 'pending'
                };
                articles.unshift(newArt);
                alert("Artikel Berhasil Disubmit! Menunggu review admin.");
            }

            localStorage.setItem('fercyArticles', JSON.stringify(articles));
            closeWriteModal();
            refreshAllData(); // Refresh all views
            if(isAdmin) renderAdminDashboard();
        }

        function deleteOneArticle(id) {
            if(confirm("Hapus artikel ini permanen?")) { articles = articles.filter(a => a.id !== id); saveAndRefresh(); }
        }
        function bulkDeleteArticles() {
            const checkboxes = document.querySelectorAll('.bulk-check:checked');
            if(checkboxes.length === 0) return alert("Pilih minimal satu artikel!");
            if(confirm(`Hapus ${checkboxes.length} artikel terpilih?`)) {
                const ids = Array.from(checkboxes).map(cb => parseInt(cb.value));
                articles = articles.filter(a => !ids.includes(a.id));
                saveAndRefresh();
            }
        }
        function toggleSelectAll(src) { document.querySelectorAll('.bulk-check').forEach(cb => cb.checked = src.checked); }
        function saveAndRefresh() { 
            localStorage.setItem('fercyArticles', JSON.stringify(articles)); 
            renderAdminDashboard(); 
            refreshAllData(); 
        }

        // --- MAIN PAGE & OPTIMIZED RENDERING ---
        const themeToggle = document.getElementById('themeToggle');
        if (localStorage.getItem('theme') === 'dark') document.body.classList.add('dark-mode');
        themeToggle.addEventListener('click', () => { document.body.classList.toggle('dark-mode'); localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light'); });

        var quill = new Quill('#editor', { theme: 'snow', modules: { toolbar: [ [{ 'header': [1, 2, 3, false] }], ['bold', 'italic', 'underline'], [{ 'align': [] }], [{ 'list': 'ordered'}, { 'list': 'bullet' }], ['link', 'image', 'video'], ['clean'] ] } });

        // Fungsi inisialisasi awal
        function refreshAllData() {
            // Reset ke kondisi awal (Semua published)
            filterArticlesByQueryAndCategory('', 'Semua', true); 
        }

        // Logic Utama Filtering (Search + Category)
        function filterArticlesByQueryAndCategory(query, category, resetPage = true) {
            if(resetPage) currentPage = 1;

            currentFilteredArticles = articles.filter(a => {
                const isPublished = a.status === 'published';
                const matchCat = category === 'Semua' || a.category === category;
                const matchQuery = query === '' || 
                                   a.title.toLowerCase().includes(query.toLowerCase()) || 
                                   a.tags.some(t => t.toLowerCase().includes(query.toLowerCase()));
                return isPublished && matchCat && matchQuery;
            });

            renderPaginatedGrid();
            updateTrendingTags();
            updateTicker();
        }

        // Fungsi Render Grid dengan Pagination (EFISIENSI TINGGI)
        function renderPaginatedGrid() {
            const grid = document.getElementById('articlesGrid');
            grid.innerHTML = '';

            const start = (currentPage - 1) * ITEMS_PER_PAGE;
            const end = start + ITEMS_PER_PAGE;
            const pageData = currentFilteredArticles.slice(start, end);

            if(pageData.length === 0) {
                grid.innerHTML = '<div style="grid-column: 1/-1; text-align:center; padding: 2rem; opacity:0.6;">Tidak ada artikel ditemukan.</div>';
                document.getElementById('paginationControls').innerHTML = '';
                return;
            }

            pageData.forEach(art => {
                const shareText = encodeURIComponent(`Baca: "${art.title}"`);
                const dummyUrl = encodeURIComponent("https://fercynews.com"); 
                
                const card = document.createElement('div'); card.className = 'article-card-container';
                // Penambahan loading="lazy" untuk performa gambar
                card.innerHTML = `
                    <div class="article-card">
                        <div class="card-front">
                            <img src="${art.image}" class="card-img" alt="Cover" loading="lazy">
                            <div class="card-content">
                                <div class="card-cat">${art.category}</div>
                                <h3 class="card-title">${art.title}</h3>
                                <div class="card-meta"><span>${art.author}</span><span>${art.date}</span></div>
                                <div style="margin-top:10px; font-size:0.8rem; color:#888;">${art.tags.join(' ')}</div>
                            </div>
                        </div>
                        <div class="card-back">
                            <h3>${art.title}</h3>
                            <div class="share-buttons">
                                <a href="https://www.facebook.com/sharer/sharer.php?u=${dummyUrl}" target="_blank" class="share-btn fb"><i class="fab fa-facebook-f"></i></a>
                                <a href="https://twitter.com/intent/tweet?text=${shareText}&url=${dummyUrl}" target="_blank" class="share-btn tw"><i class="fab fa-twitter"></i></a>
                                <a href="https://wa.me/?text=${shareText} ${dummyUrl}" target="_blank" class="share-btn wa"><i class="fab fa-whatsapp"></i></a>
                            </div>
                            <button class="btn btn-primary" onclick="openReadArticle(${art.id})">Baca Selengkapnya</button>
                        </div>
                    </div>`;
                grid.appendChild(card);
            });

            renderPaginationControls();
        }

        // Render Tombol Pagination
        function renderPaginationControls() {
            const totalPages = Math.ceil(currentFilteredArticles.length / ITEMS_PER_PAGE);
            const container = document.getElementById('paginationControls');
            container.innerHTML = '';

            if (totalPages <= 1) return;

            // Prev Button
            const prevBtn = document.createElement('button');
            prevBtn.className = 'btn btn-outline';
            prevBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
            prevBtn.onclick = () => changePage(currentPage - 1);
            if(currentPage === 1) prevBtn.disabled = true;
            container.appendChild(prevBtn);

            // Info Page
            const pageInfo = document.createElement('span');
            pageInfo.className = 'page-info';
            pageInfo.innerText = `Halaman ${currentPage} dari ${totalPages}`;
            container.appendChild(pageInfo);

            // Next Button
            const nextBtn = document.createElement('button');
            nextBtn.className = 'btn btn-outline';
            nextBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
            nextBtn.onclick = () => changePage(currentPage + 1);
            if(currentPage === totalPages) nextBtn.disabled = true;
            container.appendChild(nextBtn);
        }

        function changePage(newPage) {
            currentPage = newPage;
            renderPaginatedGrid();
            // Scroll ke atas grid agar user nyaman
            document.querySelector('main').scrollIntoView({ behavior: 'smooth' });
        }

        function updateTicker() {
            // Ticker hanya menampilkan 5 artikel terbaru dari data global (bukan yang difilter) agar tetap breaking
            const breaking = articles.filter(a => a.status === 'published').slice(0,5);
            document.getElementById('tickerContent').innerHTML = breaking.map(a => `<div class="ticker-item" onclick="openReadArticle(${a.id})">BREAKING: ${a.title}</div>`).join('');
        }

        function updateTrendingTags() {
            const published = articles.filter(a => a.status === 'published');
            let tags = [...new Set(published.flatMap(a => a.tags))];
            document.getElementById('trendingTags').innerHTML = tags.map(t => `<span class="tag" onclick="searchByTag('${t}')">${t}</span>`).join('');
        }

        function openReadArticle(id) {
            const art = articles.find(a => a.id === id); if(!art) return;
            document.getElementById('readContentContainer').innerHTML = `<div class="read-header"><img src="${art.image}" class="read-cover"></div><div class="read-body"><span style="color:var(--accent-color); font-weight:bold;">${art.category}</span><h1>${art.title}</h1><div class="read-meta">Oleh ${art.author} | ${art.date}</div><div class="read-content ql-editor">${art.content}</div></div>`;
            document.getElementById('readModal').style.display = 'block';
        }

        // Event Wrapper functions
        function handleSearch() {
            const q = document.getElementById('searchInput').value;
            filterArticlesByQueryAndCategory(q, 'Semua');
        }

        function filterByCategory(c) {
            // Reset search box visual
            document.getElementById('searchInput').value = ''; 
            filterArticlesByQueryAndCategory('', c);
        }

        function searchByTag(t) {
            document.getElementById('searchInput').value = t;
            filterArticlesByQueryAndCategory(t, 'Semua');
        }

        function openWriteModal() { 
            document.getElementById('articleForm').reset();
            document.getElementById('postId').value = "";
            document.getElementById('targetStatus').value = "pending";
            quill.root.innerHTML = "";
            document.getElementById('modalTitle').innerHTML = '<i class="fas fa-edit"></i> Kontribusi Artikel';
            
            if(isAdmin) {
                document.getElementById('userButtons').style.display = 'none';
                document.getElementById('adminButtons').style.display = 'flex';
            } else {
                document.getElementById('userButtons').style.display = 'block';
                document.getElementById('adminButtons').style.display = 'none';
            }
            document.getElementById('writeModal').style.display = 'block'; 
        }

        function closeWriteModal() { document.getElementById('writeModal').style.display = 'none'; }
        function openLoginModal() { document.getElementById('loginModal').style.display = 'block'; }
        function closeLoginModal() { document.getElementById('loginModal').style.display = 'none'; }
        function closeReadModal() { document.getElementById('readModal').style.display = 'none'; }
        function openPedomanModal() { document.getElementById('pedomanModal').style.display = 'block'; }
        function closePedomanModal() { document.getElementById('pedomanModal').style.display = 'none'; }
        window.onclick = e => { if(e.target.className === 'modal') e.target.style.display = 'none'; };

        // Initial Load
        refreshAllData();
    </script>
</body>
</html>
